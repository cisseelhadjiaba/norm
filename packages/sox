#!/bin/bash

depends_on flac ## opportunistic linking with libflac
depends_on lame ## opportunistic linking with libmp3lame
depends_on libopusfile ## opportunistic linking
depends_on libvorbis ## opportunistic linking

[[ $OSTYPE == *linux* ]] && depends_on libasound ## opportunistic linking, for playback
depends_on libsndio ## opportunistic linking
depends_on libsndfile ## opportunistic linking

#depends_on libtool ## opportunistic linking with libltdl
#depends_on libpng ## opportunistic linking

fetch_source https://prdownloads.sourceforge.net/sox/sox/14.4.2/sox-14.4.2.tar.gz f69f38f8a7ad6a88ecab3862d74db4edcd796695

CONFFLAGS=(
--without-libltdl
--without-png   ## for cover art?
--without-magic ## for detecting filetype?
--without-amrnb
--without-amrwb
--without-ao
--without-mad
--without-id3tag
--without-pulseaudio
--without-twolame
--without-wavpack
)
do_unpack
## patch out opportunistic linking with libgsm
sed -i.bak 's/gsm.h/brokenbroken/g;s/gsm_create/gsm_brokenbroken/g' "$SRCDIR"/configure
do_compile "${CONFFLAGS[@]}"
