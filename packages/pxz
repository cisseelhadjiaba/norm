#!/bin/bash

if ! cc_checkflags -fopenmp; then
    log "Formula $FORMULA needs C compiler that supports -fopenmp flag"
    log "Try installing newer version of gcc -- norm install gcc"
    exit 1
fi

depends_on xz ## for liblzma and headers

fetch_source http://http.debian.net/debian/pool/main/p/pxz/pxz_4.999.99~beta3+git659fc9b.orig.tar.bz2 ab4937e9bf1930117148a95a54e098fcab0c5954
fetch_debian http://http.debian.net/debian/pool/main/p/pxz/pxz_4.999.99~beta3+git659fc9b-3.debian.tar.xz 30f7e3fc5f95269b8dcefbd031930af36c8ec57e

do_undebian
pushd_src
sed -ibak "s|/usr/|$PREFIX/|" Makefile
sed -ibak 's|cp $(NAME) |install -m 0755 $(NAME) |' Makefile
sed -ibak 's|cp $(NAME).1 |install -m 0644 $(NAME).1 |' Makefile
do_make
do_install
popd

