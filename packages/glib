#!/bin/bash

depends_on zlib
depends_on libffi libelf
depends_on pkg-config
depends_on gettext
depends_on libpcre
depends_on python # for mandatory tests to build

fetch_source https://download.gnome.org/sources/glib/2.52/glib-2.52.2.tar.xz 50a5af7569af1a489e17f207142cd5a4cdefbf68

unset EXTRAFLAGS NEW_LDFLAGS
cc_addflags EXTRAFLAGS -Wno-format-nonliteral ## gcc 6.1 is too strict for this old glib
cc_addflags NEW_LDFLAGS -Wl,-z,defs

CPPFLAGS="$CPPFLAGS $EXTRAFLAGS" LDFLAGS="$NEW_LDFLAGS" do_unpack_compile --disable-fam --with-pcre=system --disable-libmount
