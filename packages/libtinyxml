#!/bin/bash

fetch_source http://http.debian.net/debian/pool/main/t/tinyxml/tinyxml_2.6.2.orig.tar.gz cba3f50dd657cb1434674a03b21394df9913d764
fetch_debian http://http.debian.net/debian/pool/main/t/tinyxml/tinyxml_2.6.2-4.debian.tar.xz e568d548f54e516ff509de94615f59fa5b2b1763

do_undebian
pushd_src
do_make CXXFLAGS="$CXXFLAGS -O2 -fPIC -g3 -DTIXML_USE_STL"
ar rc libtinyxml.a tinyxml.o tinyxmlparser.o tinyxmlerror.o
mkdir -p "$PREFIX/lib"
install -m644 libtinyxml.a "$PREFIX/lib/libtinyxml.a"
mkdir -p "$PREFIX/include"
install -m644 tinyxml.h "$PREFIX/include/tinyxml.h"
mkdir -p "$PREFIX/lib/pkgconfig"
sed -e "s|prefix=/usr|prefix=$PREFIX|" -e 's/${DEB_VERSION_UPSTREAM}/2.6.2/' -e 's/${DEB_HOST_MULTIARCH}//' debian/tinyxml.pc.in > "$PREFIX/lib/pkgconfig/tinyxml.pc"
popd_src
