#!/bin/bash

if ! cc_checkflags -mssse3; then
    log "Formula $FORMULA needs C compiler that supports -mssse3 flag"
    log "Try installing newer version of gcc -- norm install gcc"
    exit 1
fi

needs_tool yasm # alternatively libvpx supports nasm
## TODO: does not work with busybox diff -- diff: unrecognized option: version

fetch_source https://github.com/webmproject/libvpx/archive/v1.7.0.tar.gz fb3d4b80596d1e3b1a7f53757d63e7d2b3eeb7c9

CONFIGURE=()
[[ $OSTYPE != *darwin* ]] && CONFIGURE+=(--enable-shared)

NEEDV1=1 do_unpack_compile_notest "${CONFIGURE[@]}"
