#!/bin/bash

depends_on zlib
depends_on xz

fetch_source https://github.com/facebook/zstd/archive/v1.3.1.tar.gz bf944afb80907bc2c0ade0806d2558aa5b657f09

do_unpack
pushd_src
CPPFLAGS="$CPPFLAGS -DZSTD_MULTITHREAD -pthread" do_make -C lib PREFIX="$ESCAPED_PREFIX"
CPPFLAGS="$CPPFLAGS -DZSTD_MULTITHREAD -pthread" do_test PREFIX="$ESCAPED_PREFIX"
CPPFLAGS="$CPPFLAGS -DZSTD_MULTITHREAD -pthread" do_install PREFIX="$ESCAPED_PREFIX"
popd_src
