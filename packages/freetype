#!/bin/bash

# because of circular dependency of harfbuzz<->freetype, we compile freetype for harfbuzz and then use harfbuzz to compile freetype

needs_tool pkg-config ## freetype #2 won't find harfbuzz without pkg-config
depends_on glib ## hb-glib.h will not be generated without it, and is required by libpango later
## don't add libcairo -- it's the other way around -- cairo needs freetype

## TODO: figure out why freetype needs bzip2 or png
FREETYPE_OPTS="--enable-freetype-config --without-bzip2 --without-png"

## freetype #1 for harfbuzz
fetch_source http://downloads.sourceforge.net/freetype/freetype2/2.9/freetype-2.9.1.tar.bz2 220c82062171c513e4017c523d196933c9de4a7d
do_unpack_compile $FREETYPE_OPTS --without-harfbuzz

## harfbuzz with freshly built freetype
fetch_source http://www.freedesktop.org/software/harfbuzz/release/harfbuzz-1.8.5.tar.bz2 283c71fc7a61896cbf357faaf36f36b7a39fdf21
do_unpack_compile --without-cairo --disable-introspection --without-icu

## freetype #2 with freshly built harfbuzz
fetch_source http://downloads.sourceforge.net/freetype/freetype2/2.9/freetype-2.9.1.tar.bz2 220c82062171c513e4017c523d196933c9de4a7d
do_unpack_compile $FREETYPE_OPTS --with-harfbuzz

