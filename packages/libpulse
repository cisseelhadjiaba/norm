#!/bin/bash

needs_tool m4
depends_on libtool ## links with libltdl
needs_tool pkg-config
depends_on libsndfile

depends_on liborc ## opportunistic linking, accelerates code

fetch_source https://www.freedesktop.org/software/pulseaudio/releases/pulseaudio-12.2.tar.xz 310a6245036a51df6585a7ebfac75b32e073aa88

CONFFLAGS=(
--disable-nls
--without-caps
--disable-manpages
--disable-x11
--disable-dbus
--disable-glib2
--disable-gtk3
--disable-gsettings
--disable-gconf
--disable-avahi
--disable-systemd-daemon
--disable-systemd-login
--disable-systemd-journal
--disable-tcpwrap
--disable-udev
--disable-openssl
--disable-lirc
--disable-jack
--without-speex
--without-soxr
--with-database=simple
)

is_without tests && CONFFLAGS+=(--disable-tests)

do_unpack_compile "${CONFFLAGS[@]}"
