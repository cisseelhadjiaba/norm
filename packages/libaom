#!/bin/bash

needs_tool cmake
needs_tool nasm

! is_without tests && needs_tool python ## needed to run tests

## no hash sum because server generates different tar.gz every time
fetch_source https://aomedia.googlesource.com/aom/+archive/1ffab4fa85371630f1cc95460013704e8c192fec.tar.gz

CONFFLAGS=(
-DBUILD_SHARED_LIBS=ON
-DENABLE_EXAMPLES=OFF
-DENABLE_TOOLS=OFF
-DCONFIG_WEBM_IO=0
)

is_without tests && CONFFLAGS+=("-DCONFIG_UNIT_TESTS=0")

do_unpack --strip-components=0
do_compile_outside "${CONFFLAGS[@]}"
