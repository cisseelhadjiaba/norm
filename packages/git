#!/bin/bash

depends_on zlib

## https support
[[ $OSTYPE != *darwin* ]] && depends_on curl
depends_on libexpat

fetch_source https://www.kernel.org/pub/software/scm/git/git-2.18.0.tar.xz 5b259aecfd8e80dae1a03e74a68c77eff6d511c0
fetch_file https://www.kernel.org/pub/software/scm/git/git-manpages-2.18.0.tar.xz 37a4b9d3e2a67bb205b7594691dfbf5e8758acda
do_unpack

pushd_src
do_configure
do_make_and_install NO_GETTEXT=1 NO_TCLTK=1 V=1 NO_SVN_TESTS=1
popd_src

## install bash completion
mkdir -p "$PREFIX/etc/bash_completion.d"
install "$SRCDIR/contrib/completion/git-completion.bash" "$PREFIX/etc/bash_completion.d/git-completion.bash"

## install git manpages
mkdir -p "$PREFIX/share/man"
cat "$CACHEDIR/$FILENAME" | xz -d | tar xf - -C "$PREFIX/share/man"
