#!/bin/bash

! is_without tests && depends_on file ## tests will not work without 'file' command

fetch_source http://www.cmake.org/files/v3.12/cmake-3.12.0.tar.gz e140830af031c570b69e141f469bbab1e6cf3d0d

do_unpack
CONFFLAGS=(
--
-DCMAKE_SYSTEM_PREFIX_PATH="$PREFIX"
-DCMake_TEST_Qt4=0
-DCMAKE_USE_OPENSSL=OFF
-DBUILD_CursesDialog=OFF
)
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(-DCMAKE_USE_SYSTEM_CURL=1)
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(-DCMAKE_USE_SYSTEM_ZLIB=1)
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(-DCMAKE_USE_SYSTEM_EXPAT=1)
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(-DCMAKE_USE_SYSTEM_BZIP2=1)
is_without tests && CONFFLAGS+=(-DBUILD_TESTING=OFF)
do_compile "${CONFFLAGS[@]}"
