#!/bin/bash

depends_on liblzo
[[ $OSTYPE == *linux* ]] && depends_on libacl
[[ $OSTYPE == *linux* ]] && depends_on libuuid
depends_on libblkid
depends_on zlib
depends_on e2fsprogs
depends_on autoconf automake pkg-config
depends_on asciidoc
depends_on zstd
depends_on xmlto

fetch_source https://git.kernel.org/pub/scm/linux/kernel/git/kdave/btrfs-progs.git/snapshot/btrfs-progs-4.16.1.tar.gz 32880f5ba7eb2b7cc6aeab2ab36ee0feeaa27d0b

do_unpack
pushd_src
./autogen.sh
## their build system is oblivious to CPPFLAGS -- put them into CFLAGS
CFLAGS="-g -O2 $CPPFLAGS" do_compile --disable-python
popd_src
